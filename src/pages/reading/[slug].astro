---
import type { GetStaticPaths } from 'astro';
import type { Page } from '@utils/types';
import { getCollection, render } from 'astro:content';
import { customTypography, formatDate } from '@utils/scripts';
import ContentWrapper from '@layouts/ContentWrapper.astro';
import GlobalWrapper from '@layouts/GlobalWrapper.astro';
import PageTitle from '@components/PageTitle.astro';

export const getStaticPaths = (async () => {
  const pages: Page[] = await getCollection('pages', ({ data }) => {
    return data.type === 'Reading Year';
  });
  return pages.map((page: Page) => ({
    params: { slug: page.data.permalink },
    props: { page },
  }));
}) satisfies GetStaticPaths;

const { page } = Astro.props;
const { Content } = await render(page);
---

<GlobalWrapper pageTitle={page.data.title}>
  <PageTitle slot="title" title={page.data.title} />
  <div slot="main" class="content">
    <ContentWrapper>
      <Content components={customTypography} />
      <p>{formatDate(page.data.datePublished)}</p>
    </ContentWrapper>
  </div>
</GlobalWrapper>

<style lang="scss">
  .content {
    display: flex;
    flex-direction: column;
    gap: var(--space-30-40);
    max-width: var(--narrow-content);
    padding-top: var(--space-100-160);
  }
</style>
