---
import type { Page, PageTitleOptions } from '@utils/types';
import { customTypography } from '@utils/customTypography';
import { getEntry, render } from 'astro:content';
import GlobalWrapper from '@layouts/GlobalWrapper.astro';
import PageWide from '@layouts/PageWide.astro';
import PageTitle from '@components/PageTitle.astro';
import MarkdownWrapper from '@layouts/MarkdownWrapper.astro';

const page: Page | undefined = await getEntry('pages', 'now');
if (!page) {
  throw new Error('Could not find requested page');
}

const { Content } = await render(page);

const titleOptions: PageTitleOptions = {
  heading: page.data.title,
  subheading: 'Recent events.',
  image: {
    isShown: false,
  },
  datePublished: page.data.datePublished,
};
---

<GlobalWrapper pageTitle={page.data.title}>
  <PageWide>
    <PageTitle slot="title" titleOptions={titleOptions} />
    <MarkdownWrapper slot="content" hasBottomSection={false}>
      <Content slot="content" components={customTypography} />
    </MarkdownWrapper>
  </PageWide>
</GlobalWrapper>
